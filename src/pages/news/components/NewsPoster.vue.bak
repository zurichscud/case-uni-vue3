<script setup>
const poster = ref(null)
const tempFilePath = ref(null)

function fail(e) {
  console.log(e)
}

function done(e) {
  console.log(e)
}

function save() {
  // 如果返回的是base64是无法使用 saveImageToPhotosAlbum，需要设置 pathType为url
  poster.value.canvasToTempFilePathSync({
    fileType: 'jpg',
    quality: 1,
    success: (res) => {
      console.log(res.tempFilePath)
      tempFilePath.value = res.tempFilePath
    },
  })
}

defineExpose({
  save,
})
</script>

<template>
  <l-painter
    css="width: 750rpx; padding-bottom: 100rpx; background: linear-gradient(180deg,#ff971b 0%, #ff5000 100%)"
    :hidden="false"
    @fail="fail"
    @done="done"
    path-type="url"
    ref="poster"
    performance
  >
    <l-painter-view css="margin-top: 40rpx; padding-left: 20rpx; display: inline-block">
      <l-painter-text
        text="隔壁老六"
        css="display: block; padding-bottom: 10rpx; color: #ffffff; font-size: 32rpx; fontWeight: bold"
      />
      <l-painter-text
        text="为您挑选了一个好物?"
        css="color: rgba(255,255,255,.7); font-size: 24rpx"
      />
    </l-painter-view>
    <l-painter-view
      css="margin-left: 40rpx; margin-top: 30rpx; padding: 32rpx; box-sizing: border-box; background: #ffffff; border-radius: 16rpx; width: 670rpx; box-shadow: 0 20rpx 58rpx rgba(0,0,0,.15)"
    >
      <l-painter-image
        src="https://m.360buyimg.com/babel/jfs/t1/196317/32/13733/288158/60f4ea39E6fb378ed/d69205b1a8ed3c97.jpg"
        css="object-fit: cover; object-position: 50% 50%; width: 606rpx; height: 606rpx;"
      />
      <l-painter-view
        css="margin-top: 32rpx; color: #FF0000; font-weight: bold; font-size: 28rpx; line-height: 1em;"
      >
        <l-painter-text text="￥" css="vertical-align: bottom" />
        <l-painter-text text="39" css="vertical-align: bottom; font-size: 58rpx" />
        <l-painter-text text=".39" css="vertical-align: bottom" />
        <l-painter-text
          text="￥59.99"
          css="vertical-align: bottom; padding-left: 10rpx; font-weight: normal; text-decoration: line-through; color: #999999"
        />
      </l-painter-view>
      <l-painter-view css="margin-top: 32rpx; font-size: 26rpx; color: #8c5400">
        <l-painter-text text="自营" css="color: #212121; background: #ffb400;" />
        <l-painter-text
          text="30天最低价"
          css="margin-left: 16rpx; background: #fff4d9; text-decoration: line-through;"
        />
        <l-painter-text text="满减优惠" css="margin-left: 16rpx; background: #fff4d9" />
        <l-painter-text text="超高好评" css="margin-left: 16rpx; background: #fff4d9" />
      </l-painter-view>
      <l-painter-view css="margin-top: 30rpx; display: flex">
        <l-painter-text
          uid="tag"
          css="position:absolute; top: 6rpx; padding: 5rpx 10rpx; color: #212121; background: #ffb400; font-size: 24rpx"
          text="京东自营"
        ></l-painter-text>
        <l-painter-text
          css="text-indent: calc(tag.width + 10rpx); flex: 1; padding-right: 20rpx; box-sizing: border-box; line-clamp: 2; color: #333333; line-height: 1.8em; font-size: 36rpx;"
          text="360儿童电话手表9X 智能语音问答定位支付手表 4G全网通20米游泳级防水视频通话拍照手表男女孩星空蓝"
        ></l-painter-text>
        <l-painter-qrcode
          css="width: 128rpx; height: 128rpx;"
          text="limeui.qcoon.cn"
        ></l-painter-qrcode>
      </l-painter-view>
    </l-painter-view>
  </l-painter>
</template>

<style scoped></style>
